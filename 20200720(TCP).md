[链接](https://mp.weixin.qq.com/s/044UVaCinUdGbof-SI-3XA)

#### TCP和UDP的区别
> TCP是一个面向连接的、可靠的、基于字节流的传输层协议。
> UDP是一个面向无连接的传输层协议
> 区别
> 1. TCP是面向连接的，需要握手协议
> 2. TCP的可靠的，因为他是有状态的，可控制的
> 3. TCP是基于字节流的，UDP是基于数据报的

#### 三次握手和四次挥手
> 之前有总结

#### 第三次握手的时候可以携带数据

#### 半连接队列和SYN Flood 攻击的关系
> 三次握手前，服务端的状态从CLOSED变为LISTEN, 同时在内部创建了两个队列：半连接队列和全连接队列，即SYN队列和ACCEPT队列。
> 半连接队列:当客户端发送SYN到服务端，服务端收到以后回复ACK和SYN，状态由LISTEN变为SYN_RCVD，此时这个连接就被推入了SYN队列，也就是半连接队列。
> 全连接队列:当客户端返回ACK, 服务端接收后，三次握手完成,链接会被推入另外一个 TCP 维护的队列，也就是全连接队列(Accept Queue)。
> SYN Flood 属于典型的 DoS/DDoS 攻击。攻击的原理就是用客户端在短时间内伪造大量不存在的 IP 地址，并向服务端疯狂发送SYN
> 1. 占满整个半连接队列，无法处理正常的请求。
> 2. 服务端长时间收不到客户端的ACK，会导致服务端不断重发数据，直到耗尽服务端的资源。
> 应对dos攻击
> 1. 增加半连接队列的容量
> 2. 减少 SYN + ACK 重试次数，避免大量的超时重发
> 3. 利用 SYN Cookie 技术,在服务端接收到SYN后不立即分配连接资源，而是根据这个SYN计算出一个Cookie，连同第二次握手回复给客户端，在客户端回复ACK的时候带上这个Cookie值，服务端验证 Cookie 合法之后才分配连接资源。

#### TCP报文头部
1. 源端口、目标端口
2. 序列号seq
3. 确认号ack
4. 长度
5. timestamp

####  TCP 用滑动窗口进行流量控制